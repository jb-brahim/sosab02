{
	"info": {
		"_postman_id": "sosab-backend-collection",
		"name": "SOSAB Backend API",
		"description": "Complete API collection for SOSAB Construction Management System",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{auth_token}}",
				"type": "string"
			}
		]
	},
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:3000/api",
			"type": "string"
		},
		{
			"key": "auth_token",
			"value": "",
			"type": "string"
		},
		{
			"key": "admin_email",
			"value": "admin@sosab.com",
			"type": "string"
		},
		{
			"key": "admin_password",
			"value": "Admin123!",
			"type": "string"
		},
		{
			"key": "user_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "project_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "worker_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "material_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "supplier_id",
			"value": "",
			"type": "string"
		},
		{
			"key": "task_id",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "1. Authentication",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.token) {",
									"        pm.collectionVariables.set('auth_token', jsonData.token);",
									"        console.log('Token saved:', jsonData.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"{{admin_email}}\",\n    \"password\": \"{{admin_password}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": ["{{base_url}}"],
							"path": ["auth", "login"]
						}
					}
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/auth/logout",
							"host": ["{{base_url}}"],
							"path": ["auth", "logout"]
						}
					}
				}
			]
		},
		{
			"name": "2. Users & Roles",
			"item": [
				{
					"name": "Users",
					"item": [
						{
							"name": "Create User",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    const jsonData = pm.response.json();",
											"    if (jsonData.data && jsonData.data.id) {",
											"        pm.collectionVariables.set('user_id', jsonData.data.id);",
											"    }",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"John Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"password\": \"SecurePass123!\",\n    \"role\": \"Project Manager\",\n    \"assignedProjects\": []\n}"
								},
								"url": {
									"raw": "{{base_url}}/users",
									"host": ["{{base_url}}"],
									"path": ["users"]
								}
							}
						},
						{
							"name": "Get All Users",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users",
									"host": ["{{base_url}}"],
									"path": ["users"]
								}
							}
						},
						{
							"name": "Get User by ID",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users/:id",
									"host": ["{{base_url}}"],
									"path": ["users", ":id"],
									"variable": [
										{
											"key": "id",
											"value": "{{user_id}}"
										}
									]
								}
							}
						},
						{
							"name": "Update User",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"John Doe Updated\",\n    \"role\": \"Accountant\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/users/:id",
									"host": ["{{base_url}}"],
									"path": ["users", ":id"],
									"variable": [
										{
											"key": "id",
											"value": "{{user_id}}"
										}
									]
								}
							}
						},
						{
							"name": "Delete User",
							"request": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{base_url}}/users/:id",
									"host": ["{{base_url}}"],
									"path": ["users", ":id"],
									"variable": [
										{
											"key": "id",
											"value": "{{user_id}}"
										}
									]
								}
							}
						}
					]
				},
				{
					"name": "Roles",
					"item": [
						{
							"name": "Create Role",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"Site Supervisor\",\n    \"permissions\": [\n        \"workers.read\",\n        \"workers.update\",\n        \"attendance.create\",\n        \"materials.read\"\n    ]\n}"
								},
								"url": {
									"raw": "{{base_url}}/roles",
									"host": ["{{base_url}}"],
									"path": ["roles"]
								}
							}
						},
						{
							"name": "Get All Roles",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/roles",
									"host": ["{{base_url}}"],
									"path": ["roles"]
								}
							}
						},
						{
							"name": "Update Role",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"permissions\": [\n        \"workers.read\",\n        \"workers.update\",\n        \"workers.create\",\n        \"attendance.create\",\n        \"materials.read\",\n        \"materials.update\"\n    ]\n}"
								},
								"url": {
									"raw": "{{base_url}}/roles/:id",
									"host": ["{{base_url}}"],
									"path": ["roles", ":id"],
									"variable": [
										{
											"key": "id",
											"value": "REPLACE_WITH_ROLE_ID"
										}
									]
								}
							}
						}
					]
				}
			]
		},
		{
			"name": "3. Projects",
			"item": [
				{
					"name": "Create Project",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data._id) {",
									"        pm.collectionVariables.set('project_id', jsonData.data._id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Downtown Office Building\",\n    \"location\": \"123 Main St, City\",\n    \"budget\": 5000000,\n    \"startDate\": \"2024-01-15\",\n    \"endDate\": \"2024-12-31\",\n    \"managerId\": \"{{user_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/projects",
							"host": ["{{base_url}}"],
							"path": ["projects"]
						}
					}
				},
				{
					"name": "Get All Projects",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/projects",
							"host": ["{{base_url}}"],
							"path": ["projects"]
						}
					}
				},
				{
					"name": "Get Project by ID",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/projects/:id",
							"host": ["{{base_url}}"],
							"path": ["projects", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "{{project_id}}"
								}
							]
						}
					}
				},
				{
					"name": "Update Project",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"progress\": 25,\n    \"status\": \"Active\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/projects/:id",
							"host": ["{{base_url}}"],
							"path": ["projects", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "{{project_id}}"
								}
							]
						}
					}
				},
				{
					"name": "Delete Project",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{base_url}}/projects/:id",
							"host": ["{{base_url}}"],
							"path": ["projects", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "{{project_id}}"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "4. Workers & Attendance",
			"item": [
				{
					"name": "Workers",
					"item": [
						{
							"name": "Add Worker",
							"event": [
								{
									"listen": "test",
									"script": {
										"exec": [
											"if (pm.response.code === 201) {",
											"    const jsonData = pm.response.json();",
											"    if (jsonData.data && jsonData.data._id) {",
											"        pm.collectionVariables.set('worker_id', jsonData.data._id);",
											"    }",
											"}"
										],
										"type": "text/javascript"
									}
								}
							],
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"name\": \"Ahmed Hassan\",\n    \"projectId\": \"{{project_id}}\",\n    \"dailySalary\": 150,\n    \"contact\": {\n        \"phone\": \"+1234567890\",\n        \"address\": \"Worker Address\"\n    }\n}"
								},
								"url": {
									"raw": "{{base_url}}/workers",
									"host": ["{{base_url}}"],
									"path": ["workers"]
								}
							}
						},
						{
							"name": "Get Workers by Project",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/workers/:projectId",
									"host": ["{{base_url}}"],
									"path": ["workers", ":projectId"],
									"variable": [
										{
											"key": "projectId",
											"value": "{{project_id}}"
										}
									]
								}
							}
						},
						{
							"name": "Update Worker",
							"request": {
								"method": "PATCH",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"dailySalary\": 175\n}"
								},
								"url": {
									"raw": "{{base_url}}/workers/:id",
									"host": ["{{base_url}}"],
									"path": ["workers", ":id"],
									"variable": [
										{
											"key": "id",
											"value": "{{worker_id}}"
										}
									]
								}
							}
						}
					]
				},
				{
					"name": "Attendance",
					"item": [
						{
							"name": "Mark Attendance",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"workerId\": \"{{worker_id}}\",\n    \"projectId\": \"{{project_id}}\",\n    \"date\": \"2024-01-20\",\n    \"present\": true,\n    \"overtime\": 2,\n    \"bonus\": 50,\n    \"penalty\": 0,\n    \"notes\": \"Good performance\"\n}"
								},
								"url": {
									"raw": "{{base_url}}/attendance",
									"host": ["{{base_url}}"],
									"path": ["attendance"]
								}
							}
						},
						{
							"name": "Get Weekly Attendance",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/attendance/:projectId/:week",
									"host": ["{{base_url}}"],
									"path": ["attendance", ":projectId", ":week"],
									"variable": [
										{
											"key": "projectId",
											"value": "{{project_id}}"
										},
										{
											"key": "week",
											"value": "2024-03"
										}
									]
								}
							}
						}
					]
				},
				{
					"name": "Salary",
					"item": [
						{
							"name": "Get Weekly Salary",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{base_url}}/salary/:projectId/:week",
									"host": ["{{base_url}}"],
									"path": ["salary", ":projectId", ":week"],
									"variable": [
										{
											"key": "projectId",
											"value": "{{project_id}}"
										},
										{
											"key": "week",
											"value": "2024-03"
										}
									]
								}
							}
						},
						{
							"name": "Approve Salary",
							"request": {
								"method": "PATCH",
								"header": [],
								"url": {
									"raw": "{{base_url}}/salary/:id/approve",
									"host": ["{{base_url}}"],
									"path": ["salary", ":id", "approve"],
									"variable": [
										{
											"key": "id",
											"value": "REPLACE_WITH_SALARY_ID"
										}
									]
								}
							}
						}
					]
				}
			]
		},
		{
			"name": "5. Materials",
			"item": [
				{
					"name": "Add Material",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data._id) {",
									"        pm.collectionVariables.set('material_id', jsonData.data._id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"Cement\",\n    \"unit\": \"bag\",\n    \"price\": 25.50,\n    \"projectId\": \"{{project_id}}\",\n    \"stockQuantity\": 100,\n    \"weight\": 50,\n    \"category\": \"Construction Material\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/materials",
							"host": ["{{base_url}}"],
							"path": ["materials"]
						}
					}
				},
				{
					"name": "Get Materials by Project",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/materials/:projectId",
							"host": ["{{base_url}}"],
							"path": ["materials", ":projectId"],
							"variable": [
								{
									"key": "projectId",
									"value": "{{project_id}}"
								}
							]
						}
					}
				},
				{
					"name": "Add Material Log (IN)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"materialId\": \"{{material_id}}\",\n    \"type\": \"IN\",\n    \"quantity\": 50,\n    \"date\": \"2024-01-20\",\n    \"notes\": \"New shipment arrived\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/materials/log",
							"host": ["{{base_url}}"],
							"path": ["materials", "log"]
						}
					}
				},
				{
					"name": "Add Material Log (OUT)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"materialId\": \"{{material_id}}\",\n    \"type\": \"OUT\",\n    \"quantity\": 20,\n    \"date\": \"2024-01-20\",\n    \"workerId\": \"{{worker_id}}\",\n    \"notes\": \"Used for foundation work\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/materials/log",
							"host": ["{{base_url}}"],
							"path": ["materials", "log"]
						}
					}
				},
				{
					"name": "Get Weekly Material Usage",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/materials/log/:projectId/:week",
							"host": ["{{base_url}}"],
							"path": ["materials", "log", ":projectId", ":week"],
							"variable": [
								{
									"key": "projectId",
									"value": "{{project_id}}"
								},
								{
									"key": "week",
									"value": "2024-03"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "6. Suppliers",
			"item": [
				{
					"name": "Add Supplier",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data._id) {",
									"        pm.collectionVariables.set('supplier_id', jsonData.data._id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"ABC Construction Supplies\",\n    \"contact\": {\n        \"email\": \"contact@abcsupplies.com\",\n        \"phone\": \"+1234567890\",\n        \"address\": \"123 Supplier St\",\n        \"contactPerson\": \"John Supplier\"\n    },\n    \"rating\": 4.5,\n    \"notes\": \"Reliable supplier\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/suppliers",
							"host": ["{{base_url}}"],
							"path": ["suppliers"]
						}
					}
				},
				{
					"name": "Get All Suppliers",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/suppliers",
							"host": ["{{base_url}}"],
							"path": ["suppliers"]
						}
					}
				},
				{
					"name": "Update Supplier",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"rating\": 4.8,\n    \"notes\": \"Excellent service\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/suppliers/:id",
							"host": ["{{base_url}}"],
							"path": ["suppliers", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "{{supplier_id}}"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "7. Tasks",
			"item": [
				{
					"name": "Create Task",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    const jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data._id) {",
									"        pm.collectionVariables.set('task_id', jsonData.data._id);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"projectId\": \"{{project_id}}\",\n    \"name\": \"Foundation Work\",\n    \"description\": \"Complete foundation preparation and pouring\",\n    \"assignedWorkers\": [\"{{worker_id}}\"],\n    \"startDate\": \"2024-01-15\",\n    \"endDate\": \"2024-02-15\",\n    \"priority\": \"High\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/tasks",
							"host": ["{{base_url}}"],
							"path": ["tasks"]
						}
					}
				},
				{
					"name": "Get Tasks by Project",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/tasks/:projectId",
							"host": ["{{base_url}}"],
							"path": ["tasks", ":projectId"],
							"variable": [
								{
									"key": "projectId",
									"value": "{{project_id}}"
								}
							]
						}
					}
				},
				{
					"name": "Update Task Progress",
					"request": {
						"method": "PATCH",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"progress\": 50,\n    \"status\": \"In Progress\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/tasks/:id",
							"host": ["{{base_url}}"],
							"path": ["tasks", ":id"],
							"variable": [
								{
									"key": "id",
									"value": "{{task_id}}"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "8. Reports",
			"item": [
				{
					"name": "Generate Salary Report",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"projectId\": \"{{project_id}}\",\n    \"type\": \"salary\",\n    \"week\": \"2024-03\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reports/generate",
							"host": ["{{base_url}}"],
							"path": ["reports", "generate"]
						}
					}
				},
				{
					"name": "Generate Material Report",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"projectId\": \"{{project_id}}\",\n    \"type\": \"material\",\n    \"week\": \"2024-03\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reports/generate",
							"host": ["{{base_url}}"],
							"path": ["reports", "generate"]
						}
					}
				},
				{
					"name": "Generate Activity Report",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"projectId\": \"{{project_id}}\",\n    \"type\": \"activity\",\n    \"week\": \"2024-03\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/reports/generate",
							"host": ["{{base_url}}"],
							"path": ["reports", "generate"]
						}
					}
				},
				{
					"name": "Get Reports",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/reports?projectId={{project_id}}&week=2024-03",
							"host": ["{{base_url}}"],
							"path": ["reports"],
							"query": [
								{
									"key": "projectId",
									"value": "{{project_id}}"
								},
								{
									"key": "week",
									"value": "2024-03"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "9. Notifications",
			"item": [
				{
					"name": "Get Notifications",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/notifications/:userId",
							"host": ["{{base_url}}"],
							"path": ["notifications", ":userId"],
							"variable": [
								{
									"key": "userId",
									"value": "{{user_id}}"
								}
							]
						}
					}
				},
				{
					"name": "Mark Notification as Read",
					"request": {
						"method": "PATCH",
						"header": [],
						"url": {
							"raw": "{{base_url}}/notifications/:id/read",
							"host": ["{{base_url}}"],
							"path": ["notifications", ":id", "read"],
							"variable": [
								{
									"key": "id",
									"value": "REPLACE_WITH_NOTIFICATION_ID"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "0. Health Check",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health",
							"host": ["{{base_url}}"],
							"path": ["health"]
						}
					}
				}
			]
		}
	]
}

